# üß™ Fullstack Pet Project ‚Äî FastAPI + PostgreSQL + Autotests + Allure

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è API —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤ —Å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é –≤ Allure.

---

## ‚öôÔ∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **FastAPI** ‚Äî REST API backend
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **SQLAlchemy** ‚Äî ORM-—Å–ª–æ–π
- **Pytest** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
- **Allure** ‚Äî –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –∏ —à–∞–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **Uvicorn** ‚Äî ASGI-—Å–µ—Ä–≤–µ—Ä
- **pgAdmin** ‚Äî –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ PostgreSQL

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

fullstack_pet_project/
‚îú‚îÄ‚îÄ app/
‚îÇ ‚îú‚îÄ‚îÄ database/ # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
‚îÇ ‚îú‚îÄ‚îÄ models/ # SQLAlchemy-–º–æ–¥–µ–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ routes/ # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (auth, users, posts_db)
‚îÇ ‚îî‚îÄ‚îÄ main.py # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ tests/ # Pytest-—Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ utils/ # Allure-—à–∞–≥–∏ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è


---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### 1. üì• –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
‚ö†Ô∏è –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (venv), –Ω–µ –∑–∞–±—É–¥—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
venv\Scripts\activate  # Windows

2. üßë‚Äçüíª –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
–°–æ–∑–¥–∞–π –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö blogdb, –∏—Å–ø–æ–ª—å–∑—É—è pgAdmin –∏–ª–∏ –≤—Ä—É—á–Ω—É—é:

sql
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
CREATE DATABASE blogdb;

3. üü¢ –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
uvicorn app.main:app --reload

–û—Ç–∫—Ä–æ–π Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
http://localhost:8000/docs

üîó –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
–ú–µ—Ç–æ–¥	–ü—É—Ç—å	–û–ø–∏—Å–∞–Ω–∏–µ
POST	/auth/login	–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω
GET	/users/	–°–ø–∏—Å–æ–∫ –∏–∑ 10 –ø—Ä–µ–¥—Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
GET	/posts-db/	–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
POST	/posts-db/	–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç; –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 20 ‚Äî –æ—á–∏—â–∞–µ—Ç –±–∞–∑—É, –æ—Å—Ç–∞–≤–ª—è—è –ø–æ—Å–ª–µ–¥–Ω–∏–π

üß™ –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫:
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
pytest tests/

–° Allure-–æ—Ç—á—ë—Ç–æ–º:
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å

pytest tests/ --alluredir=allure-results
allure serve allure-results
üìå –ù–µ –∑–∞–±—É–¥—å –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª tests/conftest.py, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
import sys
import os
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))


‚ùì –¢–µ—Å—Ç "–∑–∞–≤–∏—Å–∞–µ—Ç"
‚úÖ –ü—Ä–æ–≤–µ—Ä—å:

–ó–∞–ø—É—â–µ–Ω –ª–∏ FastAPI (uvicorn)

–î–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏ timeout=5 –≤ requests.post() / get()

–ò—Å–ø–æ–ª—å–∑—É–π Ctrl+C –∏–ª–∏ –∑–∞–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª

‚ùì –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è, –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
‚û°Ô∏è –£–±–µ–¥–∏—Å—å, —á—Ç–æ:

PostgreSQL –∑–∞–ø—É—â–µ–Ω

blogdb —Å–æ–∑–¥–∞–Ω–∞

–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç (init_db() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ main.py)

–¢–∞–±–ª–∏—Ü–∞ posts —Ä–µ–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å –≤ pgAdmin)

‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–∫–∏
–ü–æ—Å–ª–µ 20 –ø–æ—Å—Ç–æ–≤ —Ç–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è, –∏ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π.

–¢–µ—Å—Ç test_cleanup_after_20_posts() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º —Å –æ—Ç—á—ë—Ç–æ–º –≤ Allure.

–í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç allure.step, attach_response, assert —Å —Ç–µ–∫—Å—Ç–∞–º–∏ ‚Äî –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è.

üìå –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–ù–∞ –≤—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (/users, /posts-db) —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω:

–í—ã–∑–æ–≤–∏ POST /auth/login

–ü–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω: "access_token": "valid_token"

–ü–µ—Ä–µ–¥–∞–≤–∞–π –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

makefile
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
Authorization: Bearer valid_token
üßπ –ü–ª–∞–Ω—ã –∏ –∏–¥–µ–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
–ü–æ–¥–∫–ª—é—á–∏—Ç—å Alembic –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ User, Comment

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å docker-compose –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–†–∞–∑–¥–µ–ª–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–∏: unit, integration, E2E